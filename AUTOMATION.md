# SiYuan Android è‡ªåŠ¨åŒ–æ„å»º

æœ¬æ–‡æ¡£è¯´æ˜å¦‚ä½•è‡ªåŠ¨åŒ–æ„å»ºå’Œä½¿ç”¨ SiYuan Android åº”ç”¨çš„èµ„æºæ–‡ä»¶ (`app.zip`)ã€‚

## ğŸ¯ æ–°æ–¹æ¡ˆè¯´æ˜

**app.zip ä¸å†æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶**ï¼Œè€Œæ˜¯é€šè¿‡ä»¥ä¸‹æ–¹å¼ä½¿ç”¨ï¼š

1. **GitHub Actions æ„å»º** - è‡ªåŠ¨æ„å»ºå¹¶å‘å¸ƒåˆ° Releases
2. **æŒ‰éœ€ä¸‹è½½** - Android æ„å»ºæ—¶è‡ªåŠ¨ä¸‹è½½æœ€æ–°ç‰ˆæœ¬
3. **æœ¬åœ°å¼€å‘** - ä½¿ç”¨è„šæœ¬æœ¬åœ°æ„å»ºæµ‹è¯•

## ğŸ“ æ–‡ä»¶è¯´æ˜

### GitHub Actions å·¥ä½œæµ

- **`build-app-zip.yml`** - åœ¨ SiYuan é¡¹ç›®ä¸­æ„å»º app.zip å¹¶å‘å¸ƒ
- **`build-android.yml`** - Android é¡¹ç›®æ„å»ºï¼Œè‡ªåŠ¨ä¸‹è½½æœ€æ–° assets

### è„šæœ¬å·¥å…·

- **`scripts/build-app-zip.sh`** - æœ¬åœ°æ„å»ºè„šæœ¬ï¼Œç”¨äºå¼€å‘å’Œæµ‹è¯•

## ğŸ¤– è‡ªåŠ¨åŒ–å·¥ä½œæµ

### æ–¹æ¡ˆï¼šæ„å»º + å‘å¸ƒ + ä¸‹è½½

#### 1. SiYuan é¡¹ç›®è‡ªåŠ¨æ„å»º (`build-app-zip.yml`)

**è§¦å‘æ—¶æœº**ï¼š
- æ¯å¤©å‡Œæ™¨ 2:00 è‡ªåŠ¨è¿è¡Œ
- æ‰‹åŠ¨è§¦å‘
- æ‰“ tag æ—¶è‡ªåŠ¨æ„å»º

**å·¥ä½œæµç¨‹**ï¼š
1. æ£€å‡º `citrusjunoss/siyuan` é¡¹ç›®
2. æ„å»ºå‰ç«¯èµ„æº (`pnpm run build`)
3. æ‰“åŒ…ä¸º `app.zip`
4. ä¸Šä¼ ä¸º GitHub Artifactï¼ˆä¿ç•™30å¤©ï¼‰
5. å‘å¸ƒåˆ° GitHub Releases (`latest-assets` tag)
6. è§¦å‘ Android é¡¹ç›®æ„å»º

#### 2. Android é¡¹ç›®è‡ªåŠ¨æ„å»º (`build-android.yml`)

**è§¦å‘æ—¶æœº**ï¼š
- æ”¶åˆ° `assets-updated` äº‹ä»¶
- æ‰‹åŠ¨è§¦å‘ï¼ˆå¯æŒ‡å®šä¸‹è½½åœ°å€ï¼‰

**å·¥ä½œæµç¨‹**ï¼š
1. ä» GitHub Releases ä¸‹è½½æœ€æ–° `app.zip`
2. æ”¾ç½®åˆ° `app/src/main/assets/`
3. æ„å»º Android APK
4. ä¸Šä¼  APK åˆ° Artifacts

## ğŸ›  æœ¬åœ°å¼€å‘

### æ„å»º app.zip

```bash
# ç¡®ä¿ SiYuan é¡¹ç›®åœ¨ä¸Šçº§ç›®å½•
./scripts/build-app-zip.sh

# æˆ–æŒ‡å®š SiYuan é¡¹ç›®è·¯å¾„
./scripts/build-app-zip.sh /path/to/siyuan
```

### æµ‹è¯• Android æ„å»º

```bash
# 1. æ„å»º app.zip
./scripts/build-app-zip.sh

# 2. å¤åˆ¶åˆ° assets ç›®å½•
mkdir -p app/src/main/assets
cp app.zip app/src/main/assets/

# 3. æ„å»º Android åº”ç”¨
./gradlew assembleDebug
```

### å‰ç½®è¦æ±‚

- **Node.js** >= 20
- **pnpm** 10.13.1
- **Java** 17 (Android æ„å»º)
- **SiYuan é¡¹ç›®** éœ€è¦åœ¨æŒ‡å®šè·¯å¾„

## ğŸš€ ä½¿ç”¨åœºæ™¯

### å¼€å‘æ¨¡å¼

1. **æœ¬åœ°å¿«é€Ÿæµ‹è¯•**ï¼šä½¿ç”¨ `build-app-zip.sh` è„šæœ¬
2. **ç‰ˆæœ¬éªŒè¯**ï¼šæ‰‹åŠ¨æŒ‡å®šç‰¹å®šç‰ˆæœ¬çš„ app.zip
3. **è°ƒè¯•æ„å»º**ï¼šåœ¨æœ¬åœ°éªŒè¯èµ„æºæ–‡ä»¶æ­£ç¡®æ€§

### ç”Ÿäº§æ¨¡å¼

1. **è‡ªåŠ¨æ›´æ–°**ï¼šCI/CD è‡ªåŠ¨ä¸‹è½½æœ€æ–° assets
2. **ç‰ˆæœ¬æ§åˆ¶**ï¼šé€šè¿‡ Releases ç®¡ç†ä¸åŒç‰ˆæœ¬çš„ assets
3. **åˆ†å¸ƒå¼æ„å»º**ï¼šAndroid æ„å»ºä¸ä¾èµ–æœ¬åœ° SiYuan é¡¹ç›®

## ğŸ“‹ èµ„æºæ–‡ä»¶å†…å®¹

### æ¥æºï¼ˆSiYuan é¡¹ç›®ï¼‰

```
app/
â”œâ”€â”€ appearance/          # å¤–è§‚ä¸»é¢˜ã€å›¾æ ‡ã€å­—ä½“
â”œâ”€â”€ changelogs/         # ç‰ˆæœ¬æ›´æ–°æ—¥å¿—  
â”œâ”€â”€ guide/              # ç”¨æˆ·æŒ‡å—æ–‡æ¡£
â””â”€â”€ stage/              # èˆå°ç›¸å…³æ–‡ä»¶
```

### è¾“å‡º

- **æ„å»ºäº§ç‰©**ï¼š`app.zip` (ä¸æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶)
- **ä½¿ç”¨ä½ç½®**ï¼š`app/src/main/assets/app.zip` (æ„å»ºæ—¶)
- **å‘å¸ƒä½ç½®**ï¼šGitHub Releases

## ğŸ”§ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡

æ— éœ€ç‰¹æ®Šé…ç½®ï¼Œä½¿ç”¨é»˜è®¤çš„ `GITHUB_TOKEN`

### æƒé™è¦æ±‚

- **è¯»å–ä»“åº“**ï¼šä¸‹è½½æºç å’Œ releases
- **åˆ›å»º releases**ï¼šå‘å¸ƒ app.zip
- **è§¦å‘å·¥ä½œæµ**ï¼šè·¨ä»“åº“äº‹ä»¶é€šä¿¡

### ä¸‹è½½åœ°å€

- **æœ€æ–°ç‰ˆæœ¬**ï¼š`https://github.com/citrusjunoss/siyuan/releases/download/latest-assets/app.zip`
- **ç‰¹å®šç‰ˆæœ¬**ï¼šé€šè¿‡ GitHub Releases API æˆ–æ‰‹åŠ¨æŒ‡å®š

## ğŸ“Š ç›‘æ§å’Œè°ƒè¯•

### æŸ¥çœ‹æ„å»ºçŠ¶æ€

1. **SiYuan é¡¹ç›®**ï¼š
   - Actions: `build-app-zip.yml`
   - Releases: æŸ¥çœ‹ `latest-assets`

2. **Android é¡¹ç›®**ï¼š
   - Actions: `build-android.yml`
   - Artifacts: ä¸‹è½½æ„å»ºçš„ APK

### æ‰‹åŠ¨æ“ä½œ

```bash
# æ‰‹åŠ¨ä¸‹è½½æœ€æ–° app.zip
curl -L -o app.zip https://github.com/citrusjunoss/siyuan/releases/download/latest-assets/app.zip

# éªŒè¯å†…å®¹
unzip -l app.zip

# ä½¿ç”¨æŒ‡å®šç‰ˆæœ¬
curl -L -o app.zip https://github.com/citrusjunoss/siyuan/releases/download/v3.2.1/app.zip
```

## âœ… ä¼˜åŠ¿

1. **ç‰ˆæœ¬æ§åˆ¶å¹²å‡€**ï¼šå¤§æ–‡ä»¶ä¸è¿›å…¥ Git å†å²
2. **æ„å»ºåˆ†ç¦»**ï¼šSiYuan å’Œ Android é¡¹ç›®ç‹¬ç«‹æ„å»º
3. **æŒ‰éœ€æ›´æ–°**ï¼šå¯ä»¥é€‰æ‹©ä½¿ç”¨ç‰¹å®šç‰ˆæœ¬çš„ assets
4. **ç¼“å­˜å‹å¥½**ï¼šæ„å»ºäº§ç‰©å¯é‡å¤ä½¿ç”¨
5. **å­˜å‚¨ä¼˜åŒ–**ï¼šé€šè¿‡ GitHub Releases ç®¡ç†å¤§æ–‡ä»¶

## ğŸ”„ å·¥ä½œæµç¨‹å›¾

```
SiYuan æ›´æ–° â†’ è‡ªåŠ¨æ„å»º app.zip â†’ å‘å¸ƒåˆ° Releases â†’ è§¦å‘ Android æ„å»º â†’ ç”Ÿæˆ APK
     â†“                â†“                    â†“                â†“              â†“
  ä»£ç å˜æ›´          CI/CDæ„å»º            Releaseç®¡ç†        è‡ªåŠ¨ä¸‹è½½        äº§ç‰©äº¤ä»˜
```

è¿™ç§æ–¹æ¡ˆæ—¢ä¿æŒäº†è‡ªåŠ¨åŒ–çš„ä¾¿åˆ©æ€§ï¼Œåˆé¿å…äº†åœ¨ç‰ˆæœ¬æ§åˆ¶ä¸­å­˜å‚¨å¤§å‹äºŒè¿›åˆ¶æ–‡ä»¶çš„é—®é¢˜ã€‚